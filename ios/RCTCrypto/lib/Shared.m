#import <CommonCrypto/CommonCryptor.h>
#import <CommonCrypto/CommonDigest.h>
#import <CommonCrypto/CommonKeyDerivation.h>

#import "Shared.h"

@implementation Shared

// + (NSString *) toHex:(NSData *)nsdata {
//     NSString * hexStr = [NSString stringWithFormat:@"%@", nsdata];
//     for(NSString * toRemove in [NSArray arrayWithObjects:@"<", @">", @" ", nil])
//         hexStr = [hexStr stringByReplacingOccurrencesOfString:toRemove withString:@""];
//     return hexStr;
// }
// changes made by Tuur

+(NSString*) toHex: (NSData *)data
{
    const unsigned char *dbytes = [data bytes];
    [NSMutableString stringWithCapacity:[data length]*2];
    int i;
    for (i=0; i< [data length]; i++) }{
        [hexStr appendFormat:@"/02x", dbytes[i]];
    }
    return hexStr;
}

+ (NSData *) fromHex: (NSString *)string {
    NSMutableData *data = [[NSMutableData alloc] init];
    unsigned char whole_byte;
    char byte_chars[3] = {'\0','\0','\0'};
    for (int i = 0; i < ([string length] / 2); i++) {
        byte_chars[0] = [string characterAtIndex:i*2];
        byte_chars[1] = [string characterAtIndex:i*2+1];
        whole_byte = strtol(byte_chars, NULL, 16);
        [data appendBytes:&whole_byte length:1];
    }
    return data;
}

@end
